
#Variables Start

$ErrorActionPreference = 'SilentlyContinue'
$ProgressPreference = 'SilentlyContinue'

$ScriptName       = 'RTDiagnostic'
$ScriptVers       = '0.1'

$DirBse = $Env:SystemDrive+'\RTSupport'    # Base working Directory

$LogName = ((Get-Date -UFormat "%Y.%m.%d_%R") -replace '[:]')+'_'+$env:COMPUTERNAME+'_'+$ScriptNme+'_v'+$ScriptVer
    $LogTmp = $DirBse+'\'+$LogName+'.tmp'
    $LogTxt = $DirBse+'\'+$LogName+'.log'




# Variables End

# Functions Start
    # Most functions that don't require security are stored in a Github public repo
    $gURL = 'https://raw.githubusercontent.com/RelayTechIT/RTDiag/main/'
    iwr -useb "$gURL`RTDiagFunctions" | iex
# Functions End

# Script Start

# Begin the script transcript to the logfile
Start-Transcript $LogTxt

# Check Pre-Requsites
#    $url = $gURL+'RTDiag-PreRequsites'; iwr -useb $url | iex
    _RunRTFunction -Function "RTDiag-PreRequsites"

# Launch menu if no errors
If (!($ErrN)) {
#    iwr -useb "$gURL`RTDiag-Menu" | iex
    _RunRTFunction -Function "RTDiag-Menu"
} else {
    _Msg -type "Fail" -Message "Script encountered errors and cannot continue."
    _Msg
    $ErrO | foreach {_Msg -type "Fail" -Message $_}
}
